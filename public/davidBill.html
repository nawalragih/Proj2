<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill Details</title>
    <link rel="stylesheet" href="styles.css"> <!-- Optional: Add your CSS file -->
</head>
<body>
    <header>
        <h1>David's Driveway Sealing Service</h1>
    </header>

    <main>
        <section class="bill-details">
            <h1>Bill Details</h1>
            <p><strong>Quote ID:</strong> <span id="quote-id">Loading...</span></p>
            <p><strong>Client ID:</strong> <span id="client-id">Loading...</span></p>
            <p><strong>Property Address:</strong> <span id="property-address">Loading...</span></p>
            <p><strong>Square Feet:</strong> <span id="square-feet">Loading...</span></p>
            <p><strong>Accepted Price:</strong> <span id="accepted-price">Loading...</span></p>
        </section>

        <section class="actions">
            <button id="finalize-button">Finalize Bill</button>
            <button id="cancel-button">Cancel</button>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 David's Driveway Sealing Service. All rights reserved.</p>
    </footer>

    <script>
        // Function to fetch quote details from the API
        async function fetchQuoteDetails(quoteId) {
        try {
            const response = await fetch(`http://localhost:3000/api/quoteRequest/${quoteId}`);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return await response.json();
        } catch (error) {
            console.error('Failed to fetch quote details:', error);
            alert('Error fetching quote details. Please try again later.');
        }
    }

    // Function to populate the bill details on the page
    function populateBillDetails() {
        const params = new URLSearchParams(window.location.search);
        const quoteId = params.get('id');

        fetchQuoteDetails(quoteId).then((quote) => {
            if (quote) {
                document.getElementById('quote-id').innerText = quote.id;
                document.getElementById('client-id').innerText = quote.clientId;
                document.getElementById('property-address').innerText = quote.propertyAddress;
                document.getElementById('square-feet').innerText = quote.squareFeet;
                document.getElementById('accepted-price').innerText = `$${quote.acceptedPrice}`;
            } else {
                alert('Quote not found.');
            }
        });
    }

    // Add event listeners for buttons
    function addEventListeners() {
        document.getElementById('finalize-button').addEventListener('click', () => {
            alert('Bill finalized!');
            // Additional functionality for saving finalized bills can be added here
        });

        document.getElementById('cancel-button').addEventListener('click', () => {
            window.history.back(); // Redirect back to the previous page
        });
    }

    // Initialize the page on load
    window.onload = function () {
        populateBillDetails();
        addEventListeners();
    };
</script>
</body>
</html>
